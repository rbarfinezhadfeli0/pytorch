# Documentation: extension_codegen_backend.py

## File Metadata
- **Path**: `test/inductor/extension_backends/triton/extension_codegen_backend.py`
- **Size**: 1392 bytes
- **Lines**: 49
- **Extension**: .py
- **Type**: Regular file

## Original Source

```py
from torch._inductor.codegen import triton, wrapper
from torch._inductor.codegen.common import DeviceOpOverrides
from torch._inductor.scheduler import BaseScheduling


class ExtensionWrapperCodegen(wrapper.PythonWrapperCodegen):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)


class ExtensionScheduling(BaseScheduling):
    def __init__(self, scheduler):
        super().__init__(scheduler)
        self._triton_scheduling = triton.TritonScheduling(scheduler)

    def can_fuse_vertical(self, node1, node2):
        return True

    def can_fuse_horizontal(self, node1, node2):
        return True

    def group_fn(self, sizes):
        return self._triton_scheduling.group_fn(sizes)

    def codegen_template(self, template_node, epilogue_nodes):
        pass

    def codegen_node(self, node):
        self._triton_scheduling.codegen_node(node)

    def codegen_sync(self):
        pass

    def flush(self):
        self._triton_scheduling.flush()


class CPUDeviceOpOverrides(DeviceOpOverrides):
    def import_get_raw_stream_as(self, name: str) -> str:
        return f"def {name}(name): None\n"

    def set_device(self, device_idx: int) -> str:  # noqa: ARG002 unused-argument
        return ""

    def synchronize(self) -> None:
        pass

    def device_guard(self, device_idx: int) -> str:  # noqa: ARG002 unused-argument
        return ""

```

## High-Level Overview

This file is part of the PyTorch repository. It is a Python source file that may contain classes, functions, and module-level code.

## Detailed Walkthrough

### Classes
This file defines 3 class(es): ExtensionWrapperCodegen, ExtensionScheduling, CPUDeviceOpOverrides

### Functions
This file defines 13 function(s): __init__, __init__, can_fuse_vertical, can_fuse_horizontal, group_fn, codegen_template, codegen_node, codegen_sync, flush, import_get_raw_stream_as, set_device, synchronize, device_guard


## Key Components

The file contains 103 words across 49 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 1392 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
