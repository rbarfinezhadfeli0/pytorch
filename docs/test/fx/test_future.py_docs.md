# Documentation: test_future.py

## File Metadata
- **Path**: `test/fx/test_future.py`
- **Size**: 1270 bytes
- **Lines**: 56
- **Extension**: .py
- **Type**: Regular file

## Original Source

```py
# Owner(s): ["module: fx"]

from __future__ import annotations  # type: ignore[attr-defined]

import torch
from torch.fx import symbolic_trace


class A:
    def __call__(self, x: torch.Tensor):
        return torch.add(x, x)


# No forward references
class M1(torch.nn.Module):
    def forward(self, x: torch.Tensor, a: A) -> torch.Tensor:
        return a(x)


# Forward references
class M2(torch.nn.Module):
    def forward(self, x: torch.Tensor, a: A) -> torch.Tensor:
        return a(x)


# Non-torch annotation with no internal forward references
class M3(torch.nn.Module):
    def forward(self, x: list[torch.Tensor], a: A) -> torch.Tensor:
        return a(x[0])


# Non-torch annotation with internal forward references
class M4(torch.nn.Module):
    def forward(self, x: list[torch.Tensor], a: A) -> torch.Tensor:
        return a(x[0])


x = torch.rand(2, 3)

ref = torch.add(x, x)

traced1 = symbolic_trace(M1())
res1 = traced1(x, A())
assert torch.all(torch.eq(ref, res1))

traced2 = symbolic_trace(M2())
res2 = traced2(x, A())
assert torch.all(torch.eq(ref, res2))

traced3 = symbolic_trace(M3())
res3 = traced3([x], A())
assert torch.all(torch.eq(ref, res3))

traced4 = symbolic_trace(M4())
res4 = traced4([x], A())
assert torch.all(torch.eq(ref, res4))

```

## High-Level Overview

This file is part of the PyTorch repository. It is a Python source file that may contain classes, functions, and module-level code.

## Detailed Walkthrough

### Classes
This file defines 5 class(es): A, M1, M2, M3, M4

### Functions
This file defines 5 function(s): __call__, forward, forward, forward, forward


## Key Components

The file contains 144 words across 56 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 1270 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
