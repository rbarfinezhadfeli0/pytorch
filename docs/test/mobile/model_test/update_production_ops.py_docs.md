# Documentation: `test/mobile/model_test/update_production_ops.py`

## File Metadata

- **Path**: `test/mobile/model_test/update_production_ops.py`
- **Size**: 1,426 bytes (1.39 KB)
- **Type**: Python Source Code
- **Extension**: `.py`

## File Purpose

This file is part of the **testing infrastructure**.

## Original Source

```python
"""
This is a script to aggregate production ops from xplat/pytorch_models/build/all_mobile_model_configs.yaml.
Specify the file path in the first argument. The results will be dump to model_ops.yaml
"""

import sys

import yaml


root_operators = {}
traced_operators = {}
kernel_metadata = {}

with open(sys.argv[1]) as input_yaml_file:
    model_infos = yaml.safe_load(input_yaml_file)
    for info in model_infos:
        for op in info["root_operators"]:
            # aggregate occurrence per op
            root_operators[op] = 1 + (root_operators.get(op, 0))
        for op in info["traced_operators"]:
            # aggregate occurrence per op
            traced_operators[op] = 1 + (traced_operators.get(op, 0))
        # merge dtypes for each kernel
        for kernal, dtypes in info["kernel_metadata"].items():
            new_dtypes = dtypes + (kernel_metadata.get(kernal, []))
            kernel_metadata[kernal] = list(set(new_dtypes))


# Only test these built-in ops. No custom ops or non-CPU ops.
namespaces = ["aten", "prepacked", "prim", "quantized"]
root_operators = {
    x: root_operators[x] for x in root_operators if x.split("::")[0] in namespaces
}
traced_operators = {
    x: traced_operators[x] for x in traced_operators if x.split("::")[0] in namespaces
}

out_path = "test/mobile/model_test/model_ops.yaml"
with open(out_path, "w") as f:
    yaml.safe_dump({"root_operators": root_operators}, f)

```



## High-Level Overview

"""This is a script to aggregate production ops from xplat/pytorch_models/build/all_mobile_model_configs.yaml.Specify the file path in the first argument. The results will be dump to model_ops.yaml

This Python file contains 0 class(es) and 0 function(s).

## Detailed Analysis

### Code Structure

**Key imports**: sys, yaml


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `test/mobile/model_test`, which is part of the **testing infrastructure**.



## Dependencies

### Import Dependencies

This file imports:

- `sys`
- `yaml`


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes


*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

This is a test file. Run it with:

```bash
python test/mobile/model_test/update_production_ops.py
```

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`test/mobile/model_test`):

- [`torchvision_models.py_docs.md`](./torchvision_models.py_docs.md)
- [`gen_test_model.py_docs.md`](./gen_test_model.py_docs.md)
- [`math_ops.py_docs.md`](./math_ops.py_docs.md)
- [`builtin_ops.py_docs.md`](./builtin_ops.py_docs.md)
- [`README.md_docs.md`](./README.md_docs.md)
- [`nn_ops.py_docs.md`](./nn_ops.py_docs.md)
- [`model_ops.yaml_docs.md`](./model_ops.yaml_docs.md)
- [`quantization_ops.py_docs.md`](./quantization_ops.py_docs.md)
- [`android_api_module.py_docs.md`](./android_api_module.py_docs.md)


## Cross-References

- **File Documentation**: `update_production_ops.py_docs.md`
- **Keyword Index**: `update_production_ops.py_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
