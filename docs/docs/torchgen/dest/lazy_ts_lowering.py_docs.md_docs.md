# Documentation: `docs/torchgen/dest/lazy_ts_lowering.py_docs.md`

## File Metadata

- **Path**: `docs/torchgen/dest/lazy_ts_lowering.py_docs.md`
- **Size**: 4,589 bytes (4.48 KB)
- **Type**: Markdown Documentation
- **Extension**: `.md`

## File Purpose

This file is part of the **documentation**.

## Original Source

```markdown
# Documentation: `torchgen/dest/lazy_ts_lowering.py`

## File Metadata

- **Path**: `torchgen/dest/lazy_ts_lowering.py`
- **Size**: 1,831 bytes (1.79 KB)
- **Type**: Python Source Code
- **Extension**: `.py`

## File Purpose

This is a python source code that is part of the PyTorch project.

## Original Source

```python
from torchgen.api.lazy import LazyArgument, LazyIrSchema
from torchgen.api.types import OptionalCType


def ts_lowering_body(schema: LazyIrSchema) -> str:
    # for now, we just want one IR class decl and soon after also the method defs
    # and we use the functional version not out/inplace.
    emplace_arguments = []

    def get_value(arg: LazyArgument) -> str:
        if isinstance(arg.lazy_type, OptionalCType):
            return f"has_{arg.name} ? loctx->GetOutputOp(operand(i++)) : nullptr"
        return "loctx->GetOutputOp(operand(i++))"

    for arg in schema.positional_args:
        if arg.is_lazy_value:
            emplace_arguments.append(get_value(arg))
            continue
        emplace_arguments.append(f'"{arg.name}", {arg.name}')

    emplace_arguments_str = "\n    ".join(
        [f"arguments.emplace_back({a});" for a in emplace_arguments]
    )
    emplace_kwarg_values = [
        f'"{arg.name}", {get_value(arg)}' for arg in schema.keyword_values
    ]
    emplace_kwarg_scalars = [
        f'"{arg.name}", {arg.name}' for arg in schema.keyword_scalars
    ]
    emplace_kwarguments = "\n    ".join(
        [
            f"kwarguments.emplace_back({a});"
            for a in emplace_kwarg_values + emplace_kwarg_scalars
        ]
    )
    return f"""\
    std::vector<torch::jit::NamedValue> arguments;
    std::vector<torch::jit::NamedValue> kwarguments;
    arguments.reserve({len(emplace_arguments)});
    kwarguments.reserve({len(emplace_kwarg_values + emplace_kwarg_scalars)});
    size_t i = 0;
    {emplace_arguments_str}
    {emplace_kwarguments}
    torch::lazy::TSOpVector {schema.aten_name}_out = torch::lazy::LowerTSBuiltin(function, op().op, arguments, kwarguments);
    TORCH_CHECK_EQ({schema.aten_name}_out.size(), {len(schema.returns)});

    return {schema.aten_name}_out;
"""

```



## High-Level Overview

return f"""\    std::vector<torch::jit::NamedValue> arguments;    std::vector<torch::jit::NamedValue> kwarguments;    arguments.reserve({len(emplace_arguments)});    kwarguments.reserve({len(emplace_kwarg_values + emplace_kwarg_scalars)});    size_t i = 0;    {emplace_arguments_str}    {emplace_kwarguments}    torch::lazy::TSOpVector {schema.aten_name}_out = torch::lazy::LowerTSBuiltin(function, op().op, arguments, kwarguments);    TORCH_CHECK_EQ({schema.aten_name}_out.size(), {len(schema.returns)});    return {schema.aten_name}_out;

This Python file contains 1 class(es) and 2 function(s).

## Detailed Analysis

### Code Structure

**Functions defined**: `ts_lowering_body`, `get_value`

**Key imports**: LazyArgument, LazyIrSchema, OptionalCType


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `torchgen/dest`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

This file imports:

- `torchgen.api.lazy`: LazyArgument, LazyIrSchema
- `torchgen.api.types`: OptionalCType


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes

- May involve **JIT compilation** or compilation optimizations.

*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`torchgen/dest`):

- [`__init__.py_docs.md`](./__init__.py_docs.md)
- [`ufunc.py_docs.md`](./ufunc.py_docs.md)
- [`lazy_ir.py_docs.md`](./lazy_ir.py_docs.md)
- [`native_functions.py_docs.md`](./native_functions.py_docs.md)
- [`register_dispatch_key.py_docs.md`](./register_dispatch_key.py_docs.md)


## Cross-References

- **File Documentation**: `lazy_ts_lowering.py_docs.md`
- **Keyword Index**: `lazy_ts_lowering.py_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*

```



## High-Level Overview

This file is part of the PyTorch framework located at `docs/torchgen/dest`.

## Detailed Analysis

### Code Structure


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `docs/torchgen/dest`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

*Dependency analysis not applicable for this file type.*


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes

- May involve **JIT compilation** or compilation optimizations.
- Contains **benchmarking** code or performance tests.

*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`docs/torchgen/dest`):

- [`register_dispatch_key.py_docs.md_docs.md`](./register_dispatch_key.py_docs.md_docs.md)
- [`native_functions.py_kw.md_docs.md`](./native_functions.py_kw.md_docs.md)
- [`ufunc.py_docs.md_docs.md`](./ufunc.py_docs.md_docs.md)
- [`lazy_ts_lowering.py_kw.md_docs.md`](./lazy_ts_lowering.py_kw.md_docs.md)
- [`lazy_ir.py_kw.md_docs.md`](./lazy_ir.py_kw.md_docs.md)
- [`__init__.py_docs.md_docs.md`](./__init__.py_docs.md_docs.md)
- [`register_dispatch_key.py_kw.md_docs.md`](./register_dispatch_key.py_kw.md_docs.md)
- [`lazy_ir.py_docs.md_docs.md`](./lazy_ir.py_docs.md_docs.md)
- [`__init__.py_kw.md_docs.md`](./__init__.py_kw.md_docs.md)


## Cross-References

- **File Documentation**: `lazy_ts_lowering.py_docs.md_docs.md`
- **Keyword Index**: `lazy_ts_lowering.py_docs.md_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
