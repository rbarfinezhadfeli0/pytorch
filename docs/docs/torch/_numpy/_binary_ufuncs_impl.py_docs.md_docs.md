# Documentation: `docs/torch/_numpy/_binary_ufuncs_impl.py_docs.md`

## File Metadata

- **Path**: `docs/torch/_numpy/_binary_ufuncs_impl.py_docs.md`
- **Size**: 4,262 bytes (4.16 KB)
- **Type**: Markdown Documentation
- **Extension**: `.md`

## File Purpose

This file is part of the **documentation**.

## Original Source

```markdown
# Documentation: `torch/_numpy/_binary_ufuncs_impl.py`

## File Metadata

- **Path**: `torch/_numpy/_binary_ufuncs_impl.py`
- **Size**: 1,871 bytes (1.83 KB)
- **Type**: Python Source Code
- **Extension**: `.py`

## File Purpose

This is a python source code that is part of the PyTorch project.

## Original Source

```python
# mypy: ignore-errors

"""Export torch work functions for binary ufuncs, rename/tweak to match numpy.
This listing is further exported to public symbols in the `torch._numpy/_ufuncs.py` module.
"""

import torch
from torch import (  # noqa: F401
    add,
    arctan2,
    bitwise_and,
    bitwise_left_shift as left_shift,
    bitwise_or,
    bitwise_right_shift as right_shift,
    bitwise_xor,
    copysign,
    divide,
    eq as equal,
    float_power,
    floor_divide,
    fmax,
    fmin,
    fmod,
    gcd,
    greater,
    greater_equal,
    heaviside,
    hypot,
    lcm,
    ldexp,
    less,
    less_equal,
    logaddexp,
    logaddexp2,
    logical_and,
    logical_or,
    logical_xor,
    maximum,
    minimum,
    multiply,
    nextafter,
    not_equal,
    pow as power,
    remainder,
    remainder as mod,
    subtract,
    true_divide,
)

from . import _dtypes_impl, _util


# work around torch limitations w.r.t. numpy
def matmul(x, y):
    # work around:
    #  - RuntimeError: expected scalar type Int but found Double
    #  - RuntimeError: "addmm_impl_cpu_" not implemented for 'Bool'
    #  - RuntimeError: "addmm_impl_cpu_" not implemented for 'Half'
    dtype = _dtypes_impl.result_type_impl(x, y)
    is_bool = dtype == torch.bool
    is_half = (x.dtype == torch.float16 or y.dtype == torch.float16) and (
        x.is_cpu or y.is_cpu
    )

    work_dtype = dtype
    if is_bool:
        work_dtype = torch.uint8
    if is_half:
        work_dtype = torch.float32

    x = _util.cast_if_needed(x, work_dtype)
    y = _util.cast_if_needed(y, work_dtype)

    result = torch.matmul(x, y)

    if work_dtype != dtype:
        result = result.to(dtype)

    return result


# a stub implementation of divmod, should be improved after
# https://github.com/pytorch/pytorch/issues/90820 is fixed in pytorch
def divmod(x, y):
    return x // y, x % y

```



## High-Level Overview

"""Export torch work functions for binary ufuncs, rename/tweak to match numpy.This listing is further exported to public symbols in the `torch._numpy/_ufuncs.py` module.

This Python file contains 0 class(es) and 2 function(s).

## Detailed Analysis

### Code Structure

**Functions defined**: `matmul`, `divmod`

**Key imports**: torch, _dtypes_impl, _util


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `torch/_numpy`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

This file imports:

- `torch`
- `.`: _dtypes_impl, _util


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes


*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`torch/_numpy`):

- [`__init__.py_docs.md`](./__init__.py_docs.md)
- [`_util.py_docs.md`](./_util.py_docs.md)
- [`_funcs_impl.py_docs.md`](./_funcs_impl.py_docs.md)
- [`_ufuncs.py_docs.md`](./_ufuncs.py_docs.md)
- [`linalg.py_docs.md`](./linalg.py_docs.md)
- [`fft.py_docs.md`](./fft.py_docs.md)
- [`README.md_docs.md`](./README.md_docs.md)
- [`_ndarray.py_docs.md`](./_ndarray.py_docs.md)
- [`random.py_docs.md`](./random.py_docs.md)


## Cross-References

- **File Documentation**: `_binary_ufuncs_impl.py_docs.md`
- **Keyword Index**: `_binary_ufuncs_impl.py_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*

```



## High-Level Overview

This file is part of the PyTorch framework located at `docs/torch/_numpy`.

## Detailed Analysis

### Code Structure


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `docs/torch/_numpy`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

*Dependency analysis not applicable for this file type.*


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes

- Contains **benchmarking** code or performance tests.

*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`docs/torch/_numpy`):

- [`_funcs_impl.py_kw.md_docs.md`](./_funcs_impl.py_kw.md_docs.md)
- [`_ndarray.py_docs.md_docs.md`](./_ndarray.py_docs.md_docs.md)
- [`_dtypes.py_kw.md_docs.md`](./_dtypes.py_kw.md_docs.md)
- [`_reductions_impl.py_kw.md_docs.md`](./_reductions_impl.py_kw.md_docs.md)
- [`_ufuncs.py_docs.md_docs.md`](./_ufuncs.py_docs.md_docs.md)
- [`fft.py_kw.md_docs.md`](./fft.py_kw.md_docs.md)
- [`README.md_docs.md_docs.md`](./README.md_docs.md_docs.md)
- [`random.py_docs.md_docs.md`](./random.py_docs.md_docs.md)
- [`_dtypes_impl.py_docs.md_docs.md`](./_dtypes_impl.py_docs.md_docs.md)
- [`_unary_ufuncs_impl.py_docs.md_docs.md`](./_unary_ufuncs_impl.py_docs.md_docs.md)


## Cross-References

- **File Documentation**: `_binary_ufuncs_impl.py_docs.md_docs.md`
- **Keyword Index**: `_binary_ufuncs_impl.py_docs.md_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
