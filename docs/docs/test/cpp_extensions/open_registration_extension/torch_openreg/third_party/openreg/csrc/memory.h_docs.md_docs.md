# Documentation: `docs/test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc/memory.h_docs.md`

## File Metadata

- **Path**: `docs/test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc/memory.h_docs.md`
- **Size**: 4,004 bytes (3.91 KB)
- **Type**: Markdown Documentation
- **Extension**: `.md`

## File Purpose

This file is part of the **testing infrastructure**. This file is part of the **documentation**.

## Original Source

```markdown
# Documentation: `test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc/memory.h`

## File Metadata

- **Path**: `test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc/memory.h`
- **Size**: 1,754 bytes (1.71 KB)
- **Type**: C/C++ Header File
- **Extension**: `.h`

## File Purpose

This file is part of the **testing infrastructure**.

## Original Source

```c
#pragma once

#include <cstddef>
#include <cstdlib>
#include <cstring>

#if defined(_WIN32)
#include <windows.h>
#else
#include <sys/mman.h>
#include <unistd.h>
#endif

#define F_PROT_NONE 0x0
#define F_PROT_READ 0x1
#define F_PROT_WRITE 0x2

namespace openreg {

void* mmap(size_t size) {
#if defined(_WIN32)
  return VirtualAlloc(nullptr, size, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE);
#else
  void* addr = ::mmap(
      nullptr,
      size,
      PROT_READ | PROT_WRITE,
      MAP_PRIVATE | MAP_ANONYMOUS,
      -1,
      0);
  return (addr == MAP_FAILED) ? nullptr : addr;
#endif
}

void munmap(void* addr, size_t size) {
#if defined(_WIN32)
  VirtualFree(addr, 0, MEM_RELEASE);
#else
  ::munmap(addr, size);
#endif
}

int mprotect(void* addr, size_t size, int prot) {
#if defined(_WIN32)
  DWORD win_prot = 0;
  DWORD old;
  if (prot == F_PROT_NONE) {
    win_prot = PAGE_NOACCESS;
  } else {
    win_prot = PAGE_READWRITE;
  }

  return VirtualProtect(addr, size, win_prot, &old) ? 0 : -1;
#else
  int native_prot = 0;
  if (prot == F_PROT_NONE)
    native_prot = PROT_NONE;
  else {
    if (prot & F_PROT_READ)
      native_prot |= PROT_READ;
    if (prot & F_PROT_WRITE)
      native_prot |= PROT_WRITE;
  }

  return ::mprotect(addr, size, native_prot);
#endif
}

int alloc(void** mem, size_t alignment, size_t size) {
#ifdef _WIN32
  *mem = _aligned_malloc(size, alignment);
  return *mem ? 0 : -1;
#else
  return posix_memalign(mem, alignment, size);
#endif
}

void free(void* mem) {
#ifdef _WIN32
  _aligned_free(mem);
#else
  ::free(mem);
#endif
}

long get_pagesize() {
#ifdef _WIN32
  SYSTEM_INFO si;
  GetSystemInfo(&si);
  return static_cast<long>(si.dwPageSize);
#else
  return sysconf(_SC_PAGESIZE);
#endif
}

} // namespace openreg

```



## High-Level Overview


This C++ file contains approximately 0 class(es)/struct(s) and 14 function(s).

## Detailed Analysis

### Code Structure

**Namespaces**: `openreg`


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

This file includes:

- `cstddef`
- `cstdlib`
- `cstring`
- `windows.h`
- `sys/mman.h`
- `unistd.h`


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes


*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

This is a test file. Run it with:

```bash
python test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc/memory.h
```

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc`):

- [`memory.cpp_docs.md`](./memory.cpp_docs.md)
- [`stream.cpp_docs.md`](./stream.cpp_docs.md)
- [`device.cpp_docs.md`](./device.cpp_docs.md)


## Cross-References

- **File Documentation**: `memory.h_docs.md`
- **Keyword Index**: `memory.h_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*

```



## High-Level Overview

This file is part of the PyTorch framework located at `docs/test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc`.

## Detailed Analysis

### Code Structure


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `docs/test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

*Dependency analysis not applicable for this file type.*


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes

- Contains **benchmarking** code or performance tests.

*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

This is a test file. Run it with:

```bash
python docs/test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc/memory.h_docs.md
```

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`docs/test/cpp_extensions/open_registration_extension/torch_openreg/third_party/openreg/csrc`):

- [`memory.cpp_docs.md_docs.md`](./memory.cpp_docs.md_docs.md)
- [`stream.cpp_docs.md_docs.md`](./stream.cpp_docs.md_docs.md)
- [`device.cpp_docs.md_docs.md`](./device.cpp_docs.md_docs.md)
- [`memory.h_kw.md_docs.md`](./memory.h_kw.md_docs.md)
- [`device.cpp_kw.md_docs.md`](./device.cpp_kw.md_docs.md)
- [`memory.cpp_kw.md_docs.md`](./memory.cpp_kw.md_docs.md)
- [`stream.cpp_kw.md_docs.md`](./stream.cpp_kw.md_docs.md)


## Cross-References

- **File Documentation**: `memory.h_docs.md_docs.md`
- **Keyword Index**: `memory.h_docs.md_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
