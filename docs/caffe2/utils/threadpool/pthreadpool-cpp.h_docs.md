# Documentation: pthreadpool-cpp.h

## File Metadata
- **Path**: `caffe2/utils/threadpool/pthreadpool-cpp.h`
- **Size**: 1464 bytes
- **Lines**: 55
- **Extension**: .h
- **Type**: Regular file

## Original Source

```h
#pragma once

#ifdef USE_PTHREADPOOL

#ifdef USE_INTERNAL_PTHREADPOOL_IMPL
#include <caffe2/utils/threadpool/pthreadpool.h>
#else
#include <pthreadpool.h>
#endif

#include <functional>
#include <memory>
#include <mutex>

namespace caffe2 {

class PThreadPool final {
 public:
  explicit PThreadPool(size_t thread_count);
  ~PThreadPool() = default;

  PThreadPool(const PThreadPool&) = delete;
  PThreadPool& operator=(const PThreadPool&) = delete;

  PThreadPool(PThreadPool&&) = delete;
  PThreadPool& operator=(PThreadPool&&) = delete;

  size_t get_thread_count() const;
  void set_thread_count(size_t thread_count);

  // Run, in parallel, function fn(task_id) over task_id in range [0, range).
  // This function is blocking.  All input is processed by the time it returns.
  void run(const std::function<void(size_t)>& fn, size_t range);

 private:
  friend pthreadpool_t pthreadpool_();

 private:
  mutable std::mutex mutex_;
  std::unique_ptr<pthreadpool, decltype(&pthreadpool_destroy)> threadpool_;
};

// Return a singleton instance of PThreadPool for ATen/TH multithreading.
PThreadPool* pthreadpool();
PThreadPool* pthreadpool(size_t thread_count);

// Exposes the underlying implementation of PThreadPool.
// Only for use in external libraries so as to unify threading across
// internal (i.e. ATen, etc.) and external (e.g. NNPACK, QNNPACK, XNNPACK)
// use cases.
pthreadpool_t pthreadpool_();

} // namespace caffe2

#endif /* USE_PTHREADPOOL */

```

## High-Level Overview

This file is part of the PyTorch repository. It is a C++/CUDA source/header file that may contain implementations, declarations, or kernel code.

## Detailed Walkthrough

### Classes
This file defines 1 class(es): PThreadPool


## Key Components

The file contains 157 words across 55 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 1464 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
