# Documentation: _tensor_info.py

## File Metadata
- **Path**: `functorch/dim/_tensor_info.py`
- **Size**: 2039 bytes
- **Lines**: 68
- **Extension**: .py
- **Type**: Regular file

## Original Source

```py
from __future__ import annotations

from dataclasses import dataclass
from typing import Any, Optional, TYPE_CHECKING

import torch


if TYPE_CHECKING:
    from ._dim_entry import DimEntry


@dataclass
class TensorInfo:
    tensor: Optional[torch.Tensor]
    levels: list[DimEntry]
    has_device: bool
    batchedtensor: Optional[torch.Tensor]

    def __post_init__(self) -> None:
        from ._dim_entry import DimEntry

        assert all(isinstance(l, DimEntry) for l in self.levels)

    def ndim(self) -> int:
        from ._dim_entry import ndim_of_levels

        return ndim_of_levels(self.levels)

    def __bool__(self) -> bool:
        return self.tensor is not None

    @staticmethod
    def create(
        h: Any, ensure_batched: bool = True, ensure_present: bool = True
    ) -> TensorInfo:
        from . import Dim, DimEntry, Tensor

        if Tensor.check_exact(h):
            # functorch Tensor with first-class dimensions
            return TensorInfo(
                h._get_tensor(),
                h._get_levels(),
                h._get_has_device(),
                h._get_batchtensor() if ensure_batched else None,
            )
        elif Dim.check_exact(h):
            # For Dim objects, only get range/batchtensor if needed and dimension is bound
            tensor = h._get_range() if h.is_bound else None
            batchtensor = (
                h._get_batchtensor() if ensure_batched and h.is_bound else None
            )
            return TensorInfo(
                tensor,
                [DimEntry(h)],
                False,
                batchtensor,
            )
        elif isinstance(h, torch.Tensor):
            # Plain torch tensor - create positional levels
            levels = []
            for i in range(-h.dim(), 0):
                levels.append(DimEntry(i))
            return TensorInfo(h, levels, True, h)
        else:
            if ensure_present:
                raise ValueError("expected a tensor object")
            return TensorInfo(None, [], False, None)

```

## High-Level Overview

This file is part of the PyTorch repository. It is a Python source file that may contain classes, functions, and module-level code.

## Detailed Walkthrough

### Classes
This file defines 1 class(es): class

### Functions
This file defines 4 function(s): __post_init__, ndim, __bool__, create


## Key Components

The file contains 186 words across 68 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 2039 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
