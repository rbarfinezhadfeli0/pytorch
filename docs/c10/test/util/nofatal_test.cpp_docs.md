# Documentation: `c10/test/util/nofatal_test.cpp`

## File Metadata

- **Path**: `c10/test/util/nofatal_test.cpp`
- **Size**: 1,656 bytes (1.62 KB)
- **Type**: C++ Source Code
- **Extension**: `.cpp`

## File Purpose

This file is part of the **testing infrastructure**. This appears to be a **test file**.

## Original Source

```cpp
#include <gtest/gtest.h>

#include <c10/util/Exception.h>
#include <c10/util/Logging.h>

namespace {
template <typename T>
inline void expectThrowsEq(T&& fn, const char* expected_msg) {
  try {
    std::forward<T>(fn)();
  } catch (const c10::Error& e) {
    EXPECT_TRUE(
        std::string(e.what_without_backtrace()).find(expected_msg) !=
        std::string::npos);
    return;
  }
  ADD_FAILURE() << "Expected to throw exception with message \"" << expected_msg
                << "\" but didn't throw";
}
} // namespace

TEST(NofatalTest, TorchCheckComparisons) {
  // quick make sure that no-op works as expected
  TORCH_CHECK_EQ(1, 1) << "i am a silly message " << 1;
  expectThrowsEq(
      []() { TORCH_CHECK_EQ(1, 2) << "i am a silly message " << 1; },
      "Check failed: 1 == 2 (1 vs. 2). i am a silly message 1");
  expectThrowsEq(
      []() { TORCH_CHECK_NE(2, 2); }, "Check failed: 2 != 2 (2 vs. 2).");
  expectThrowsEq(
      []() { TORCH_CHECK_LT(2, 2); }, "Check failed: 2 < 2 (2 vs. 2).");
  expectThrowsEq(
      []() { TORCH_CHECK_LE(3, 2); }, "Check failed: 3 <= 2 (3 vs. 2).");
  expectThrowsEq(
      []() { TORCH_CHECK_GT(2, 2); }, "Check failed: 2 > 2 (2 vs. 2).");
  expectThrowsEq(
      []() { TORCH_CHECK_GE(2, 3); }, "Check failed: 2 >= 3 (2 vs. 3).");
  expectThrowsEq(
      []() {
        void* p = nullptr;
        TORCH_CHECK_NOTNULL(p);
      },
      "Check failed: 'p' must be non NULL.");

#if GTEST_HAS_DEATH_TEST
#ifndef NDEBUG
  // if dbg build, DCHECK should result in deth
  EXPECT_DEATH(TORCH_DCHECK_EQ(1, 2), "Check failed");
#else
  TORCH_DCHECK_EQ(1, 2); // no-op
#endif
#endif // GTEST_HAS_DEATH_TEST
}

```



## High-Level Overview


This C++ file contains approximately 0 class(es)/struct(s) and 5 function(s).

## Detailed Analysis

### Code Structure

**Namespaces**: `TEST`


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `c10/test/util`, which is part of **C10** (Caffe2 Core), the core library providing fundamental abstractions.



## Dependencies

### Import Dependencies

This file includes:

- `gtest/gtest.h`
- `c10/util/Exception.h`
- `c10/util/Logging.h`


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes


*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

This is a test file. Run it with:

```bash
python c10/test/util/nofatal_test.cpp
```

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`c10/test/util`):

- [`bfloat16_test.cpp_docs.md`](./bfloat16_test.cpp_docs.md)
- [`complex_test_common.h_docs.md`](./complex_test_common.h_docs.md)
- [`TypeIndex_test.cpp_docs.md`](./TypeIndex_test.cpp_docs.md)
- [`generic_math_test.cpp_docs.md`](./generic_math_test.cpp_docs.md)
- [`Half_test.cpp_docs.md`](./Half_test.cpp_docs.md)
- [`small_vector_test.cpp_docs.md`](./small_vector_test.cpp_docs.md)
- [`exception_test.cpp_docs.md`](./exception_test.cpp_docs.md)
- [`string_view_test.cpp_docs.md`](./string_view_test.cpp_docs.md)
- [`Enumerate_test.cpp_docs.md`](./Enumerate_test.cpp_docs.md)


## Cross-References

- **File Documentation**: `nofatal_test.cpp_docs.md`
- **Keyword Index**: `nofatal_test.cpp_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
