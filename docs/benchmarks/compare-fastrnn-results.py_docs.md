# Documentation: `benchmarks/compare-fastrnn-results.py`

## File Metadata

- **Path**: `benchmarks/compare-fastrnn-results.py`
- **Size**: 2,195 bytes (2.14 KB)
- **Type**: Python Source Code
- **Extension**: `.py`

## File Purpose

This file contains **examples or benchmarks**.

## Original Source

```python
import argparse
import json
from collections import namedtuple


Result = namedtuple("Result", ["name", "base_time", "diff_time"])


def construct_name(fwd_bwd, test_name):
    bwd = "backward" in fwd_bwd
    suite_name = fwd_bwd.replace("-backward", "")
    return f"{suite_name}[{test_name}]:{'bwd' if bwd else 'fwd'}"


def get_times(json_data):
    r = {}
    for fwd_bwd in json_data:
        for test_name in json_data[fwd_bwd]:
            name = construct_name(fwd_bwd, test_name)
            r[name] = json_data[fwd_bwd][test_name]
    return r


parser = argparse.ArgumentParser("compare two pytest jsons")
parser.add_argument("base", help="base json file")
parser.add_argument("diff", help="diff json file")
parser.add_argument(
    "--format", default="md", type=str, help="output format (csv, md, json, table)"
)
args = parser.parse_args()

with open(args.base) as base:
    base_times = get_times(json.load(base))
with open(args.diff) as diff:
    diff_times = get_times(json.load(diff))

all_keys = set(base_times.keys()).union(diff_times.keys())
results = [
    Result(name, base_times.get(name, float("nan")), diff_times.get(name, float("nan")))
    for name in sorted(all_keys)
]

header_fmt = {
    "table": "{:48s} {:>13s} {:>15s} {:>10s}",
    "md": "| {:48s} | {:>13s} | {:>15s} | {:>10s} |",
    "csv": "{:s}, {:s}, {:s}, {:s}",
}
data_fmt = {
    "table": "{:48s} {:13.6f} {:15.6f} {:9.1f}%",
    "md": "| {:48s} | {:13.6f} | {:15.6f} | {:9.1f}% |",
    "csv": "{:s}, {:.6f}, {:.6f}, {:.2f}%",
}

if args.format in ["table", "md", "csv"]:
    header_fmt_str = header_fmt[args.format]
    data_fmt_str = data_fmt[args.format]
    print(header_fmt_str.format("name", "base time (s)", "diff time (s)", "% change"))
    if args.format == "md":
        print(header_fmt_str.format(":---", "---:", "---:", "---:"))
    for r in results:
        print(
            data_fmt_str.format(
                r.name,
                r.base_time,
                r.diff_time,
                (r.diff_time / r.base_time - 1.0) * 100.0,
            )
        )
elif args.format == "json":
    print(json.dumps(results))
else:
    raise ValueError("Unknown output format: " + args.format)

```



## High-Level Overview


This Python file contains 0 class(es) and 2 function(s).

## Detailed Analysis

### Code Structure

**Functions defined**: `construct_name`, `get_times`

**Key imports**: argparse, json, namedtuple


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `benchmarks`, which is part of the PyTorch project infrastructure.



## Dependencies

### Import Dependencies

This file imports:

- `argparse`
- `json`
- `collections`: namedtuple


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes


*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`benchmarks`):

- [`README.md_docs.md`](./README.md_docs.md)
- [`compare.sh_docs.md`](./compare.sh_docs.md)
- [`upload_scribe.py_docs.md`](./upload_scribe.py_docs.md)


## Cross-References

- **File Documentation**: `compare-fastrnn-results.py_docs.md`
- **Keyword Index**: `compare-fastrnn-results.py_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
