# Documentation: `.ci/docker/common/install_user.sh`

## File Metadata

- **Path**: `.ci/docker/common/install_user.sh`
- **Size**: 1,142 bytes (1.12 KB)
- **Type**: Shell Script
- **Extension**: `.sh`

## File Purpose

This file is part of the **documentation**.

## Original Source

```bash
#!/bin/bash

set -ex

# Since version 24 the system ships with user 'ubuntu' that has id 1000
# We need a work-around to enable id 1000 usage for this script
if [[ $UBUNTU_VERSION == 24.04 ]]; then
    # touch is used to disable harmless error message
    touch /var/mail/ubuntu && chown ubuntu /var/mail/ubuntu && userdel -r ubuntu
fi

# Mirror jenkins user in container
# jenkins user as ec2-user should have the same user-id
echo "jenkins:x:1000:1000::/var/lib/jenkins:" >> /etc/passwd
echo "jenkins:x:1000:" >> /etc/group
# Needed on focal or newer
echo "jenkins:*:19110:0:99999:7:::" >>/etc/shadow

# Create $HOME
mkdir -p /var/lib/jenkins
chown jenkins:jenkins /var/lib/jenkins
mkdir -p /var/lib/jenkins/.ccache
chown jenkins:jenkins /var/lib/jenkins/.ccache

# Allow writing to /usr/local (for make install)
chown jenkins:jenkins /usr/local

# Allow sudo
# TODO: Maybe we shouldn't
echo 'jenkins ALL=(ALL) NOPASSWD:ALL' > /etc/sudoers.d/jenkins

# Work around bug where devtoolset replaces sudo and breaks it.
if [ -n "$DEVTOOLSET_VERSION" ]; then
  SUDO=/bin/sudo
else
  SUDO=sudo
fi

# Test that sudo works
$SUDO -u jenkins $SUDO -v

```



## High-Level Overview

This file is part of the PyTorch framework located at `.ci/docker/common`.

## Detailed Analysis

### Code Structure


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `.ci/docker/common`, which is part of the PyTorch project infrastructure.



## Dependencies

### Import Dependencies

*Dependency analysis not applicable for this file type.*


## Code Patterns & Idioms

### Common Patterns

*No specific patterns automatically detected.*


## Performance Considerations

### Performance Notes

- Implements or uses **caching** mechanisms.

*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`.ci/docker/common`):

- [`install_mnist.sh_docs.md`](./install_mnist.sh_docs.md)
- [`install_amdsmi.sh_docs.md`](./install_amdsmi.sh_docs.md)
- [`install_openblas.sh_docs.md`](./install_openblas.sh_docs.md)
- [`install_magma.sh_docs.md`](./install_magma.sh_docs.md)
- [`install_cuda.sh_docs.md`](./install_cuda.sh_docs.md)
- [`common_utils.sh_docs.md`](./common_utils.sh_docs.md)
- [`install_inductor_benchmark_deps.sh_docs.md`](./install_inductor_benchmark_deps.sh_docs.md)
- [`install_gcc.sh_docs.md`](./install_gcc.sh_docs.md)
- [`install_clang.sh_docs.md`](./install_clang.sh_docs.md)


## Cross-References

- **File Documentation**: `install_user.sh_docs.md`
- **Keyword Index**: `install_user.sh_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
