# Documentation: FlattenIndices.metal

## File Metadata
- **Path**: `aten/src/ATen/native/sparse/mps/kernels/FlattenIndices.metal`
- **Size**: 647 bytes
- **Lines**: 19
- **Extension**: .metal
- **Type**: Regular file

## Original Source

```metal
#include <metal_stdlib>
using namespace metal;


kernel void flatten_indices_kernel(
    device const long* indices        [[ buffer(0) ]],
    device const long* row_muls       [[ buffer(1) ]],
    device long*       flat_indices   [[ buffer(2) ]],
    constant uint&     sparse_dim     [[ buffer(3) ]],
    constant long2&    idx_strides    [[ buffer(4) ]],
    uint               gid            [[ thread_position_in_grid ]]) {
  long flat = 0;
  for (uint d = 0; d < sparse_dim; ++d) {
    long off = (long)d * idx_strides.x + (long)gid * idx_strides.y;
    long v = indices[off];
    flat += v * row_muls[d];
  }
  flat_indices[gid] = flat;
}
```

## High-Level Overview

This file is part of the PyTorch repository. It is a source or configuration file.

## Detailed Walkthrough


## Key Components

The file contains 84 words across 19 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 647 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
