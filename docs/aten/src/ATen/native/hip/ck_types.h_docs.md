# Documentation: ck_types.h

## File Metadata
- **Path**: `aten/src/ATen/native/hip/ck_types.h`
- **Size**: 1642 bytes
- **Lines**: 75
- **Extension**: .h
- **Type**: Regular file

## Original Source

```h
/*
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree.
 */

// work around CK assuming only a single FP8 interpretation at a time
#if(defined(__gfx940__) || defined(__gfx941__) || defined(__gfx942__)) && __HIP_DEVICE_COMPILE__
#define CK_USE_FNUZ_FP8 1
#undef CK_USE_OCP_FP8
#elif __HIP_DEVICE_COMPILE__
#undef CK_USE_FNUZ_FP8
#define CK_USE_OCP_FP8 1
#endif

#include <ATen/ATen.h>
#include <ck/ck.hpp>
#include <ck/tensor_operation/gpu/device/tensor_layout.hpp>
#include <ck/utility/data_type.hpp>

using Row = ck::tensor_layout::gemm::RowMajor;
using Col = ck::tensor_layout::gemm::ColumnMajor;

namespace at::native {

template <typename T>
struct CkMathType {
  using dtype = T;
};

template <>
struct CkMathType<at::BFloat16> {
  using dtype = ck::bhalf_t;
};

template <>
struct CkMathType<at::Half> {
  using dtype = ck::half_t;
};

template <bool A, bool B>
struct CkTensorLayout {
  // default goes to row-wise for now
  using a_layout = Row;
  using b_layout = Row;
};

// True denotes transpose is necessary. Default is Col, so return Row
template <>
struct CkTensorLayout<true, true> {
  using a_layout = Col;
  using b_layout = Col;
};

template <>
struct CkTensorLayout<true, false> {
  using a_layout = Row;
  using b_layout = Col;
};

template <>
struct CkTensorLayout<false, true> {
  using a_layout = Col;
  using b_layout = Row;
};

template <>
struct CkTensorLayout<false, false> {
  using a_layout = Row;
  using b_layout = Row;
};

} // namespace at::native

```

## High-Level Overview

This file is part of the PyTorch repository. It is a C++/CUDA source/header file that may contain implementations, declarations, or kernel code.

## Detailed Walkthrough

### Structures
This file defines 8 struct(s): CkMathType, CkMathType, CkMathType, CkTensorLayout, CkTensorLayout, CkTensorLayout, CkTensorLayout, CkTensorLayout


## Key Components

The file contains 222 words across 75 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 1642 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
