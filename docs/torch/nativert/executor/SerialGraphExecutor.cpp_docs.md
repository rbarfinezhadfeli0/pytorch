# Documentation: SerialGraphExecutor.cpp

## File Metadata
- **Path**: `torch/nativert/executor/SerialGraphExecutor.cpp`
- **Size**: 1405 bytes
- **Lines**: 40
- **Extension**: .cpp
- **Type**: Regular file

## Original Source

```cpp
#include <torch/nativert/executor/ExecutionPlanner.h>
#include <torch/nativert/executor/ExecutorConfig.h>
#include <torch/nativert/executor/SerialGraphExecutor.h>

namespace torch::nativert {

std::vector<c10::IValue> SerialGraphExecutor::execute(
    ExecutionFrame& executionFrame,
    std::vector<c10::IValue> inputs) {
  fillUserInputs(executionFrame, std::move(inputs));

  return executeWithPrefilledFrame(executionFrame);
}

std::vector<c10::IValue> SerialGraphExecutor::executeWithPrefilledFrame(
    ExecutionFrame& executionFrame) {
  executionFrame.withManagedMemory([&](const LayoutManager* layout_manager) {
    // Execute kernels for all nodes except prim.Input and prim.Output
    for (NodeIndex nodeIdx = 1; nodeIdx < nodeKernels_.size() - 1; ++nodeIdx) {
      nodeKernels_[nodeIdx]->compute(executionFrame);

#ifndef NDEBUG
      if (layout_manager != nullptr) {
        layout_manager->assert_no_overlapping_storages(nodeIdx);
      }
#endif

      // don't free intermediate values when static memory planning is enabled
      if (executorConfig_.tryFreeUnmanagedValuesAfterUse) {
        // Free the intermediate values that are no used anymore
        for (const auto& valueKey : execPlan_->valuesToFree[nodeIdx]) {
          executionFrame.releaseValueIfNeeded(valueKey);
        }
      }
    }
  });
  return executionFrame.tryMoveUserOutputs();
}

} // namespace torch::nativert

```

## High-Level Overview

This file is part of the PyTorch repository. It is a C++/CUDA source/header file that may contain implementations, declarations, or kernel code.

## Detailed Walkthrough


## Key Components

The file contains 106 words across 40 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 1405 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
