# Documentation: PTMCoreMLFeatureProvider.mm

## File Metadata
- **Path**: `torch/csrc/jit/backends/coreml/objc/PTMCoreMLFeatureProvider.mm`
- **Size**: 1532 bytes
- **Lines**: 57
- **Extension**: .mm
- **Type**: Regular file

## Original Source

```mm
#import <torch/csrc/jit/backends/coreml/objc/PTMCoreMLFeatureProvider.h>

@implementation PTMCoreMLFeatureProvider {
  NSMutableDictionary *_featureValuesForName;
}

@synthesize featureNames = _featureNames;

- (instancetype)initWithFeatureNames:(NSSet<NSString *> *)featureNames {
  if (self = [super init]) {
    _featureNames = featureNames;
    _featureValuesForName = [NSMutableDictionary dictionary];
  }
  return self;
}

- (void)clearInputTensors {
  @synchronized(_featureValuesForName) {
    [_featureValuesForName removeAllObjects];
  }
}

- (void)setInputTensor:(const at::Tensor&)tensor forFeatureName:(NSString *)name {
  NSMutableArray *shape = [NSMutableArray new];
  for (auto& dim : tensor.sizes().vec()) {
    [shape addObject:@(dim)];
  }

  NSMutableArray *strides = [NSMutableArray new];
  for (auto& step : tensor.strides().vec()) {
    [strides addObject:@(step)];
  }

  NSError* error = nil;
  MLMultiArray *mlArray =
    [[MLMultiArray alloc]
     initWithDataPointer:tensor.mutable_data_ptr<float>()
     shape:shape
     dataType:MLMultiArrayDataTypeFloat32
     strides:strides
     deallocator:(^(void* bytes){})
     error:&error];
  MLFeatureValue *value = [MLFeatureValue featureValueWithMultiArray:mlArray];
  if (value) {
    @synchronized(_featureValuesForName) {
      _featureValuesForName[name] = value;
    }
  }
}

- (nullable MLFeatureValue *)featureValueForName:(NSString *)featureName {
  @synchronized(_featureValuesForName) {
    return _featureValuesForName[featureName];
  }
}

@end

```

## High-Level Overview

This file is part of the PyTorch repository. It is a source or configuration file.

## Detailed Walkthrough


## Key Components

The file contains 122 words across 57 lines of code/text.

## Usage & Examples

This file is part of the larger PyTorch codebase. For usage examples, refer to related test files and documentation.

## Performance & Security Notes

- File size: 1532 bytes
- Complexity: Standard

## Related Files

See the folder index for related files in the same directory.

## Testing

Refer to the PyTorch test suite for test coverage of this file.

---
*Generated by Repo Book Generator v1.0*
