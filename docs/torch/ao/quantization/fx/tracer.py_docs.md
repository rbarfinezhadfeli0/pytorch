# Documentation: `torch/ao/quantization/fx/tracer.py`

## File Metadata

- **Path**: `torch/ao/quantization/fx/tracer.py`
- **Size**: 1,697 bytes (1.66 KB)
- **Type**: Python Source Code
- **Extension**: `.py`

## File Purpose

This is a python source code that is part of the PyTorch project.

## Original Source

```python
from collections.abc import Callable

import torch
from torch.ao.nn.intrinsic import _FusedModule
from torch.fx._symbolic_trace import Tracer
from torch.fx.proxy import Scope


__all__ = [
    "QuantizationTracer",
]


class ScopeContextManager(torch.fx.proxy.ScopeContextManager):
    def __init__(
        self, scope: Scope, current_module: torch.nn.Module, current_module_path: str
    ):
        super().__init__(scope, Scope(current_module_path, type(current_module)))


class QuantizationTracer(Tracer):
    def __init__(
        self, skipped_module_names: list[str], skipped_module_classes: list[Callable]
    ):
        super().__init__()
        self.skipped_module_names = skipped_module_names
        self.skipped_module_classes = skipped_module_classes
        # NB: initialized the module_type of top level module to None
        # we are assuming people won't configure the model with the type of top level
        # module here, since people can use "" for global config
        # We can change this if there is a use case that configures
        # qconfig using top level module type
        self.scope = Scope("", None)
        self.record_stack_traces = True

    def is_leaf_module(self, m: torch.nn.Module, module_qualified_name: str) -> bool:
        return (
            (
                (
                    m.__module__.startswith("torch.nn")
                    or m.__module__.startswith("torch.ao.nn")
                )
                and not isinstance(m, torch.nn.Sequential)
            )
            or module_qualified_name in self.skipped_module_names
            or type(m) in self.skipped_module_classes
            or isinstance(m, _FusedModule)
        )

```



## High-Level Overview


This Python file contains 2 class(es) and 3 function(s).

## Detailed Analysis

### Code Structure

**Classes defined**: `ScopeContextManager`, `QuantizationTracer`

**Functions defined**: `__init__`, `__init__`, `is_leaf_module`

**Key imports**: Callable, torch, _FusedModule, Tracer, Scope


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `torch/ao/quantization/fx`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

This file imports:

- `collections.abc`: Callable
- `torch`
- `torch.ao.nn.intrinsic`: _FusedModule
- `torch.fx._symbolic_trace`: Tracer
- `torch.fx.proxy`: Scope


## Code Patterns & Idioms

### Common Patterns

- **Object-Oriented Design**: Uses classes and constructors
- **Neural Network**: Defines or uses PyTorch neural network components


## Performance Considerations

### Performance Notes


*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`torch/ao/quantization/fx`):

- [`lstm_utils.py_docs.md`](./lstm_utils.py_docs.md)
- [`__init__.py_docs.md`](./__init__.py_docs.md)
- [`_lower_to_native_backend.py_docs.md`](./_lower_to_native_backend.py_docs.md)
- [`utils.py_docs.md`](./utils.py_docs.md)
- [`convert.py_docs.md`](./convert.py_docs.md)
- [`lower_to_fbgemm.py_docs.md`](./lower_to_fbgemm.py_docs.md)
- [`_equalize.py_docs.md`](./_equalize.py_docs.md)
- [`_decomposed.py_docs.md`](./_decomposed.py_docs.md)
- [`graph_module.py_docs.md`](./graph_module.py_docs.md)
- [`fuse.py_docs.md`](./fuse.py_docs.md)


## Cross-References

- **File Documentation**: `tracer.py_docs.md`
- **Keyword Index**: `tracer.py_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
