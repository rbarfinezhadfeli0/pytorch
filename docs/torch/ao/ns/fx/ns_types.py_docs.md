# Documentation: `torch/ao/ns/fx/ns_types.py`

## File Metadata

- **Path**: `torch/ao/ns/fx/ns_types.py`
- **Size**: 2,354 bytes (2.30 KB)
- **Type**: Python Source Code
- **Extension**: `.py`

## File Purpose

This is a python source code that is part of the PyTorch project.

## Original Source

```python
import enum
from collections.abc import Callable
from typing import Any, NamedTuple, Union

from torch.fx.graph import Node


class NSSingleResultValuesType(str, enum.Enum):
    WEIGHT = "weight"
    NODE_OUTPUT = "node_output"
    NODE_INPUT = "node_input"


class NSSubgraph(NamedTuple):
    start_node: Node
    end_node: Node
    base_op_node: Node


# TODO(future PR): see if we can use typing_extensions's TypedDict instead
# to properly type the various keys
# {
#   # one of NSSingleResultValuesType
#   'type': 'weight',
#   # the values of type specified above
#   'values': [torch.tensor(...), ...],
#   # name of the node directly before the logger
#   'prev_node_name': 'linear1',
#   # type of the underlying function or module
#   'prev_node_target_type': torch.nn.functional.linear  # or torch.nn.Linear, etc
#   # name of the node responsible for adding this logger
#   # Note: this may differ from prev_node_name if we are logging inputs
#   'ref_node_name': 'linear1',
#   # index of this node within the arg of the input/output node
#   # for example, in cat([x1, x2, x3], dim=0), x2 would have index_within_arg == 1
#   'index_within_arg': 0,
#   # index of this node within the args of the input/output node
#   # for example, in add(x1, x2), x2 would have index_of_arg == 1
#   'index_of_arg': 0,
#   # precomputed comparisons of logger values to reference values
#   'comparisons': [torch.tensor(...), ...]
#   # name of function used for precomputed comparisons
#   'comparison_fn_name': 'sqnr',
#   # string representation of qconfig responsible for creating this logger
#   'qconfig_str': 'QConfig(...)',
# }
NSSingleResultType = dict[str, Any]

# {
#   'layer_name_1': {  # subgraph name
#     'node_output': {  # results type (node_output, node_input, weight)
#       'model_name_a':  # model name
#          [NSSingleResultType, ...],  # results, ordered by index_within_arg
#       'model_name_b':
#          [NSSingleResultType, ...],
#     },
#   },
# }
#
NSResultsType = dict[str, dict[str, dict[str, list[NSSingleResultType]]]]

# Defines the underlying target type of a node, for example:
# `F.conv1d` for a `call_function` conv node
# `nn.Conv1d` for a `call_module` node calling the forward of a `nn.Conv1d` module
# `'sigmoid'` for a `call_method` node calling `x.sigmoid()`
NSNodeTargetType = Union[Callable, str]

```



## High-Level Overview


This Python file contains 2 class(es) and 0 function(s).

## Detailed Analysis

### Code Structure

**Classes defined**: `NSSingleResultValuesType`, `NSSubgraph`

**Key imports**: enum, Callable, Any, NamedTuple, Union, Node


*For complete code details, see the Original Source section above.*


## Architecture & Design

### Role in PyTorch Architecture

This file is located in `torch/ao/ns/fx`, which is part of the **core PyTorch library**.



## Dependencies

### Import Dependencies

This file imports:

- `enum`
- `collections.abc`: Callable
- `typing`: Any, NamedTuple, Union
- `torch.fx.graph`: Node


## Code Patterns & Idioms

### Common Patterns

- **Neural Network**: Defines or uses PyTorch neural network components


## Performance Considerations

### Performance Notes


*Detailed performance analysis requires profiling and benchmarking.*


## Security & Safety

### Security Considerations

- No obvious security concerns detected in automated analysis.

*Manual security review is recommended for production code.*


## Testing & Usage

### Testing

Test files for this module may be located in the `test/` directory.

### Usage Examples

*See the source code and related test files for usage examples.*


## Related Files

### Related Files

Files in the same folder (`torch/ao/ns/fx`):

- [`qconfig_multi_mapping.py_docs.md`](./qconfig_multi_mapping.py_docs.md)
- [`__init__.py_docs.md`](./__init__.py_docs.md)
- [`graph_matcher.py_docs.md`](./graph_matcher.py_docs.md)
- [`utils.py_docs.md`](./utils.py_docs.md)
- [`weight_utils.py_docs.md`](./weight_utils.py_docs.md)
- [`pattern_utils.py_docs.md`](./pattern_utils.py_docs.md)
- [`mappings.py_docs.md`](./mappings.py_docs.md)
- [`graph_passes.py_docs.md`](./graph_passes.py_docs.md)
- [`n_shadows_utils.py_docs.md`](./n_shadows_utils.py_docs.md)


## Cross-References

- **File Documentation**: `ns_types.py_docs.md`
- **Keyword Index**: `ns_types.py_kw.md`
- **Folder Index**: `index.md`
- **Folder Documentation**: `doc.md`

---

*Generated by PyTorch Repository Documentation System*
